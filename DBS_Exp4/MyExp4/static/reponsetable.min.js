(function(b){b.fn.reponsetable=function(e){var c=$(this).attr("id");a.rendertable(e,c);var d=$(this).find("tr");$("tr").click(function(g){var f=a.resiverowdata(this,c)})};var a={rendertable:function(n,d){var q="<thead><tr>";var m="<tbody>";for(var l=0;l<n.colum.length;l++){var c='<th data-field="'+n.colum[l].field+'">'+n.colum[l].title+"</th>";q+=c}if(n.operation!==""||n!=null){q+='<th data-field="'+n.operation+'">操作</th>'}q+="</tr></thead>";for(var l=0;l<n.data.length;l++){m+="<tr>";for(var h=0;h<n.colum.length;h++){var r=n.colum[h].field;var e=n.colum[h].title;var p=n.data[l][r];if(p==undefined){p=""}var g='<td data-field="'+r+'" data-th="'+e+'">'+p+"</td>";m+=g}if(n.operation!==""||n!=null){var o=$("#"+n.operation).html();m+='<td data-th="操作">'+o+"</td>"}m+="</tr>"}m+="</tbody>";$("#"+d).prepend(q);$("#"+d).append(m);var f=$("#"+d).find("tbody tr");var k=[];for(var l=0;l<f.length;l++){var t=$(f[l]).find("td");var u={};for(var h=0;h<t.length;h++){var r=$(t[h]).attr("data-field");var s=$(t[h]).text();if(r!=undefined){u[r]=s}}k.push(u)}n.data=k;$("#"+d).data("tableObj",n)},deletetr:function(d,c){$(d).remove();if(c&&c.stopPropagation){c.stopPropagation()}else{window.event.cancelBubble=true}},addtr:function(f,c){var h=$("#"+c).data("tableObj");var l="<tr>";for(var g=0;g<h.colum.length;g++){var m=h.colum[g].field;var d=h.colum[g].title;var k=f[m];if(k==undefined){k=""}var e='<td data-field="'+m+'" data-th="'+d+'">'+k+"</td>";l+=e}if(h.operation!==""||h!=null){var j=$("#"+h.operation).html();l+='<td data-th="操作">'+j+"</td>"}l+="</tr>";$("#"+c+" tbody").append(l)},resiverowdata:function(j,d,g){var h=$(j).parent().is("thead");if(!h){$(j).addClass("yesbei").siblings().removeClass("yesbei")}var l=$(j).find("td");var f={};for(var c=0;c<l.length;c++){field=$(l[c]).attr("data-field");content=$(l[c]).text();if(field!=undefined){f[field]=content}}var j=$("#"+d).data("row",j);var k=$("#"+d).data("rowdata",f);return f;if(g&&g.stopPropagation){g.stopPropagation()}else{window.event.cancelBubble=true}},editsavetr:function(j,f,h){var k=$("#"+f).data("row");if(k==undefined){alert("请选中要编辑的行");return}var l=$(k).find("td");for(var d=0;d<l.length;d++){var g=$(l[d]).attr("data-field");var c=$(l[d]).hasClass("bt-hide");if(j[g]!=undefined||j[g]!=null){$(l[d]).text(j[g])}}if(h&&h.stopPropagation){h.stopPropagation()}else{window.event.cancelBubble=true}},moveuptr:function(h,c,g){if(h!=null){var f=h}else{f=$("#"+c).data("row")}if(f==undefined){alert("请选择要移动的行")}else{var d=$(f).prev();if($(f).index()>0){$(f).insertBefore(d)}else{alert("已经移到最顶部")}}if(g&&g.stopPropagation){g.stopPropagation()}else{window.event.cancelBubble=true}},moveDown:function(h,c,g){if(h!=null){var f=h}else{f=$("#"+c).data("row")}if(f==undefined){alert("请选择要移动的行")}else{var d=$(f).next();if(d.index()>0){$(f).insertAfter(d)}else{alert("已经移到最底部")}}if(g&&g.stopPropagation){g.stopPropagation()}else{window.event.cancelBubble=true}},JSONToCSVConvertor:function(m,j,l){var f=typeof m!=="object"?JSON.parse(m):m;var g="";if(j){var o="";for(var e=0;e<f.colum.length;e++){o+=f.colum[e].title+","}o=o.slice(0,-1);g+=o+"\r\n"}for(var e=0;e<f.data.length;e++){var o="";for(var h in f.data[e]){var c=f.data[e][h]==null?"":'="'+f.data[e][h]+'"';o+=c+","}o.slice(0,o.length-1);g+=o+"\r\n"}if(g==""){growl.error("Invalid data");return}if(this.msieversion()){var n=window.open();n.document.write("sep=,\r\n"+g);n.document.close();n.document.execCommand("SaveAs",true,l+".xls");n.close()}else{var d="data:text/xls;charset=utf-8,\uFEFF"+encodeURI(g);var k=document.createElement("a");k.href=d;k.style="visibility:hidden";k.download=l+".xls";document.body.appendChild(k);k.click();document.body.removeChild(k)}},msieversion:function(){var d=window.navigator.userAgent;var c=d.indexOf("MSIE ");if(c>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}return false},reloadtable:function(d,c){var e=$("#"+c).data("tableObj");e.data=d;$("#"+c).html("");this.rendertable(e,c)},Columndata:function(d,f){var c=[];var h=$("#"+f).find("td[data-field="+d+"]");for(var e=0;e<h.length;e++){var g=$(h[e]).text();c.push(g)}return c}};window.reponse=a}(jQuery));